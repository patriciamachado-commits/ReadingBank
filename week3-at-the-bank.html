<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Week 3: At the Bank</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=DM+Serif+Display&display=swap" rel="stylesheet">
<style>
:root{
  --primary:#0f766e;
  --primary-light:#14b8a6;
  --primary-dark:#134e4a;
  --accent:#f59e0b;
  --bg:#f0fdfa;
  --card:#ffffff;
  --text:#134e4a;
  --text-light:#5f9ea0;
  --success:#10b981;
  --error:#ef4444;
  --border:#99f6e4;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:'DM Sans',system-ui,sans-serif;
  background:var(--bg);
  min-height:100vh;
  color:var(--text);
  line-height:1.6;
}
.container{
  max-width:700px;
  margin:0 auto;
  padding:20px;
  min-height:100vh;
}
.header{
  text-align:center;
  padding:30px 0;
}
.week-badge{
  display:inline-block;
  background:var(--primary);
  color:#fff;
  font-size:0.8rem;
  font-weight:600;
  padding:6px 14px;
  border-radius:20px;
  margin-bottom:12px;
  letter-spacing:0.5px;
}
h1{
  font-family:'DM Serif Display',serif;
  font-size:2rem;
  color:var(--primary-dark);
  margin-bottom:8px;
}
.subtitle{
  font-size:1rem;
  color:var(--text-light);
}
.card{
  background:var(--card);
  border:2px solid var(--border);
  border-radius:16px;
  padding:24px;
  margin-bottom:20px;
  box-shadow:0 4px 20px rgba(15,118,110,0.08);
}
.form-group{
  margin-bottom:20px;
}
.form-label{
  display:block;
  font-weight:600;
  margin-bottom:8px;
  color:var(--primary-dark);
}
.form-input{
  width:100%;
  padding:14px 16px;
  border:2px solid var(--border);
  border-radius:10px;
  font-size:1rem;
  font-family:inherit;
  transition:all 0.2s;
}
.form-input:focus{
  outline:none;
  border-color:var(--primary);
  box-shadow:0 0 0 4px rgba(15,118,110,0.1);
}
.level-grid{
  display:grid;
  gap:12px;
}
.level-btn{
  background:linear-gradient(135deg,#f0fdfa,#ccfbf1);
  border:2px solid var(--border);
  border-radius:12px;
  padding:18px;
  cursor:pointer;
  text-align:left;
  transition:all 0.2s;
}
.level-btn:hover{
  border-color:var(--primary);
  transform:translateY(-2px);
  box-shadow:0 4px 15px rgba(15,118,110,0.15);
}
.level-btn.selected{
  border-color:var(--primary);
  background:linear-gradient(135deg,#ccfbf1,#99f6e4);
}
.level-name{
  font-weight:700;
  font-size:1.1rem;
  color:var(--primary-dark);
  margin-bottom:4px;
}
.level-desc{
  font-size:0.9rem;
  color:var(--text-light);
}
.btn{
  padding:14px 28px;
  border-radius:10px;
  border:none;
  font-size:1rem;
  font-weight:600;
  cursor:pointer;
  transition:all 0.2s;
  font-family:inherit;
}
.btn-primary{
  background:linear-gradient(135deg,var(--primary),var(--primary-dark));
  color:#fff;
  box-shadow:0 4px 15px rgba(15,118,110,0.3);
  width:100%;
}
.btn-primary:hover{
  transform:translateY(-2px);
  box-shadow:0 6px 20px rgba(15,118,110,0.4);
}
.btn-primary:disabled{
  opacity:0.5;
  cursor:not-allowed;
  transform:none;
}
.reading-content{
  background:linear-gradient(135deg,#f0fdf4,#dcfce7);
  border:2px solid #86efac;
  border-radius:12px;
  padding:24px;
  margin:20px 0;
  line-height:1.8;
}
.reading-title{
  font-family:'DM Serif Display',serif;
  font-size:1.4rem;
  color:#166534;
  margin-bottom:15px;
  display:flex;
  align-items:center;
  gap:10px;
}
.story-text{
  color:#166534;
  margin-bottom:15px;
  font-size:1.05rem;
}
.story-text p{
  margin-bottom:12px;
}
.vocab-box{
  background:rgba(255,255,255,0.7);
  border-left:4px solid #22c55e;
  padding:15px;
  margin:20px 0;
  border-radius:0 8px 8px 0;
}
.vocab-title{
  font-weight:700;
  color:#15803d;
  margin-bottom:10px;
  font-size:1rem;
}
.vocab-item{
  margin-bottom:8px;
  font-size:0.95rem;
  color:#166534;
}
.vocab-item strong{
  color:#15803d;
}
.question-card{
  background:#fff;
  border:2px solid var(--border);
  border-radius:12px;
  padding:20px;
  margin-bottom:15px;
}
.question-num{
  display:inline-block;
  background:var(--primary);
  color:#fff;
  width:28px;
  height:28px;
  border-radius:50%;
  text-align:center;
  line-height:28px;
  font-weight:600;
  font-size:0.9rem;
  margin-right:10px;
}
.question-text{
  font-weight:600;
  color:var(--primary-dark);
  margin-bottom:15px;
  font-size:1.05rem;
}
.options{
  display:grid;
  gap:10px;
}
.option{
  display:flex;
  align-items:center;
  gap:12px;
  padding:14px 16px;
  background:#f0fdfa;
  border:2px solid var(--border);
  border-radius:10px;
  cursor:pointer;
  transition:all 0.2s;
}
.option:hover{
  border-color:var(--primary-light);
  background:#ccfbf1;
}
.option.selected{
  border-color:var(--primary);
  background:#ccfbf1;
}
.option.correct{
  border-color:var(--success);
  background:#d1fae5;
}
.option.incorrect{
  border-color:var(--error);
  background:#fee2e2;
}
.option-letter{
  width:28px;
  height:28px;
  border-radius:50%;
  background:var(--border);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:600;
  font-size:0.9rem;
  color:var(--primary-dark);
}
.option.selected .option-letter{
  background:var(--primary);
  color:#fff;
}
.option-text{
  flex:1;
  color:var(--text);
}
.progress-bar{
  background:var(--border);
  border-radius:10px;
  height:10px;
  margin-bottom:20px;
  overflow:hidden;
}
.progress-fill{
  background:linear-gradient(90deg,var(--primary-light),var(--primary));
  height:100%;
  transition:width 0.3s ease;
}
.progress-text{
  text-align:center;
  font-size:0.9rem;
  color:var(--text-light);
  margin-bottom:10px;
}
.results-card{
  text-align:center;
  padding:30px 20px;
}
.results-icon{
  font-size:4rem;
  margin-bottom:15px;
}
.results-title{
  font-family:'DM Serif Display',serif;
  font-size:1.8rem;
  color:var(--primary-dark);
  margin-bottom:10px;
}
.results-score{
  font-size:3rem;
  font-weight:700;
  color:var(--primary);
  margin:15px 0;
}
.results-message{
  font-size:1.1rem;
  color:var(--text-light);
  margin-bottom:25px;
}
.results-details{
  background:#f0fdfa;
  border-radius:10px;
  padding:15px;
  margin:20px 0;
  text-align:left;
}
.results-row{
  display:flex;
  justify-content:space-between;
  padding:8px 0;
  border-bottom:1px solid var(--border);
}
.results-row:last-child{
  border-bottom:none;
}
.nav-row{
  display:flex;
  gap:10px;
  margin-top:20px;
}
.nav-row .btn{
  flex:1;
}
.btn-secondary{
  background:#f0fdfa;
  color:var(--primary);
  border:2px solid var(--border);
}
.btn-secondary:hover{
  background:#ccfbf1;
  border-color:var(--primary);
}
.audio-btn{
  background:rgba(15,118,110,0.1);
  border:1px solid var(--border);
  color:var(--primary);
  padding:8px 14px;
  border-radius:8px;
  cursor:pointer;
  font-size:0.9rem;
  display:inline-flex;
  align-items:center;
  gap:6px;
  margin-bottom:15px;
  transition:all 0.2s;
}
.audio-btn:hover{
  background:rgba(15,118,110,0.2);
}
.footer-note{
  text-align:center;
  padding:20px;
  color:var(--text-light);
  font-size:0.85rem;
}
.submitted-msg{
  background:#d1fae5;
  border:2px solid #10b981;
  border-radius:10px;
  padding:15px;
  text-align:center;
  color:#065f46;
  margin-top:20px;
}
.dialogue{
  background:rgba(255,255,255,0.5);
  border-radius:8px;
  padding:12px 15px;
  margin:10px 0;
  font-style:italic;
}
.article-source{
  font-size:0.85rem;
  color:#15803d;
  font-style:italic;
  margin-bottom:15px;
}
</style>
</head>
<body>
<div class="container" id="app"></div>

<script>
// READING CONTENT FOR EACH LEVEL
const READINGS = {
  A1: {
    title: "Tom Goes to the Bank",
    content: `
      <div class="story-text">
        <p>Tom needs to go to the bank today. He lives in New York. His bank is on Main Street.</p>
        <p>Tom walks into the bank at 10:00 a.m. He waits in line for five minutes. Then a bank employee says, "Next, please!"</p>
        <p>Tom walks to the counter. A woman is there. Her name is Angela. She smiles and says, "Good morning! How can I help you?"</p>
        <p>Tom says, "Hello. I want to deposit money."</p>
        <p>Angela asks, "How much money do you want to deposit?"</p>
        <p>Tom says, "I want to deposit $200."</p>
        <p>Angela counts the money. She gives Tom a receipt. The receipt shows his new balance: $1,450.</p>
        <p>Tom says, "Thank you. I also need to withdraw $50."</p>
        <p>Angela says, "No problem." She gives Tom $50 in cash.</p>
        <p>Tom asks, "Can I check my balance?"</p>
        <p>Angela says, "Yes, of course. Your balance is now $1,400."</p>
        <p>Tom smiles. He says, "Perfect. Thank you very much!"</p>
        <p>Angela says, "You're welcome! Have a nice day!"</p>
        <p>Tom leaves the bank. He is happy. The bank visit was easy and quick.</p>
      </div>
      
      <div class="vocab-box">
        <div class="vocab-title">üìö Vocabulary Help:</div>
        <div class="vocab-item"><strong>deposit</strong> = put money into your bank account</div>
        <div class="vocab-item"><strong>withdraw</strong> = take money out of your bank account</div>
        <div class="vocab-item"><strong>receipt</strong> = paper that shows your transaction</div>
        <div class="vocab-item"><strong>balance</strong> = total money in your account</div>
        <div class="vocab-item"><strong>counter</strong> = desk where the bank employee works</div>
      </div>
    `
  },
  A2B1: {
    title: "Laura Opens a Savings Account",
    content: `
      <div class="story-text">
        <p>Laura moved to Chicago three months ago for a new job. She has been working as a nurse at a local hospital, and she's finally saving some money. Last week, she decided it was time to open a savings account because she wants to buy a car next year.</p>
        
        <p>On Monday morning, Laura called her bank to make an appointment. The customer service representative told her she could come in that afternoon at 3:00 p.m. Laura was nervous because she had never opened a savings account before, and English is her second language.</p>
        
        <p>When Laura arrived at the bank, she checked in at the reception desk. A friendly employee named Tom greeted her and said, "You must be Laura. I'll be helping you today. Please follow me to my office."</p>
        
        <p>They sat down, and Tom explained the different types of savings accounts. "We have two main options," he said. "The first account has no monthly fee, but the interest rate is only 0.5%. The second account requires a minimum balance of $500, but it offers a 2% interest rate."</p>
        
        <p>Laura thought carefully. She had $800 to deposit today, and she planned to add $200 every month from her paycheck. "I think I want the account with the higher interest rate," she said. "I can maintain the minimum balance."</p>
        
        <p>"That's a great choice," Tom replied. "You'll earn more money over time. Now, I need to see two forms of identification, please."</p>
        
        <p>Laura showed him her driver's license and her passport. Tom made copies and entered her information into the computer. Then he asked, "Would you like to set up automatic transfers from your checking account to your savings account each month?"</p>
        
        <p>"Yes, that sounds convenient," Laura answered. "Can I transfer $200 on the first day of every month?"</p>
        
        <p>"Absolutely," Tom said. "I'll set that up for you right now."</p>
        
        <p>After fifteen minutes, everything was complete. Tom handed Laura her new debit card and some documents. "Your savings account is now active," he explained. "You can check your balance anytime using our mobile app or online banking. You'll receive your PIN in the mail within five business days."</p>
        
        <p>Laura felt relieved and proud of herself. "Thank you so much for your help and patience," she said. "This was easier than I expected."</p>
        
        <p>"You're very welcome," Tom said with a smile. "If you have any questions in the future, just give us a call. Congratulations on taking this important step for your financial future!"</p>
        
        <p>As Laura walked out of the bank, she felt confident. She was building a better life in her new country, one step at a time.</p>
      </div>
      
      <div class="vocab-box">
        <div class="vocab-title">üìö Vocabulary Help:</div>
        <div class="vocab-item"><strong>savings account</strong> = a bank account where you keep money to save for the future</div>
        <div class="vocab-item"><strong>interest rate</strong> = the percentage of money the bank pays you for keeping money in your account</div>
        <div class="vocab-item"><strong>minimum balance</strong> = the smallest amount of money you must keep in your account</div>
        <div class="vocab-item"><strong>automatic transfer</strong> = money that moves from one account to another automatically</div>
        <div class="vocab-item"><strong>debit card</strong> = a card you use to take money from your bank account</div>
        <div class="vocab-item"><strong>PIN</strong> = Personal Identification Number (secret code for your card)</div>
        <div class="vocab-item"><strong>financial future</strong> = your plans for money in the years to come</div>
      </div>
    `
  },
  B2C1: {
    title: "Traditional Banks Struggle as Digital Banks Become More Popular",
    content: `
      <div class="article-source">Chicago Tribune - Money & Business</div>
      
      <div class="story-text">
        <p>The banking industry is changing rapidly. Traditional banks with physical branches are facing strong competition from digital-only banks that operate entirely through mobile apps and websites. These new competitors are especially popular with younger customers.</p>
        
        <p>A recent study by the Federal Reserve found that nearly 40% of Americans under 35 now do all their banking through mobile apps. They never visit a physical bank branch. This major change has forced traditional banks to close many branches and invest heavily in their own digital services.</p>
        
        <p>"We're seeing a complete change in how people manage their money," says Dr. Patricia Chen, an economist at Northwestern University. "The COVID-19 pandemic sped up this trend, but the convenience of digital banking is so attractive that most people won't go back to visiting branches regularly."</p>
        
        <p>Digital banks, also called "fintech" companies, have attracted millions of customers by offering several advantages. Companies like Chime, Varo, and SoFi provide free checking accounts, better interest rates on savings, and easy-to-use apps. Customers can manage their finances automatically, see their spending in real-time, and access their money instantly. Most importantly, these banks have removed many common frustrations: no minimum balance requirements, no overdraft fees, and customer service available 24 hours a day.</p>
        
        <p>However, traditional banks are fighting back. Large banks like JPMorgan Chase, Bank of America, and Wells Fargo have invested billions of dollars in creating better digital platforms. They believe their long history and experience give them an advantage. "Trust is our greatest strength," explains Marcus Rodriguez, Chief Digital Officer at a major bank. "Young customers might like fancy apps, but when they need a mortgage, a business loan, or investment advice, they still want the personal service and expertise that established banks can offer."</p>
        
        <p>Government regulation makes the situation more complicated. Digital banks must follow the same strict rules as traditional banks, but their new business models sometimes don't fit existing regulations. The Federal Deposit Insurance Corporation (FDIC) is updating its rules to protect customer deposits while allowing innovation to continue.</p>
        
        <p>Some experts worry that the move toward digital banking could hurt certain groups of people. Older adults, people living in rural areas with poor internet, and those who prefer talking to someone in person may have fewer options. "We need to make sure that digital progress doesn't leave people behind," warns Jennifer Williams, director of a consumer protection organization. "Banking is essential, and everyone should have access to it."</p>
        
        <p>Looking ahead, it's clear that banking in 2030 will be very different from today. Banks might merge, create partnerships, or develop new innovations. For customers, this competition could be good news. All banks‚Äîtraditional and digital‚Äîwill need to offer better services, lower fees, and more personalized experiences to survive in this changing industry.</p>
      </div>
      
      <div class="vocab-box">
        <div class="vocab-title">üìö Vocabulary Help:</div>
        <div class="vocab-item"><strong>digital-only banks</strong> = banks that exist only online, with no physical branches</div>
        <div class="vocab-item"><strong>physical branches</strong> = actual bank buildings you can visit</div>
        <div class="vocab-item"><strong>fintech</strong> = financial technology; companies that use technology to provide banking services</div>
        <div class="vocab-item"><strong>minimum balance</strong> = the smallest amount of money required to keep an account open</div>
        <div class="vocab-item"><strong>overdraft fees</strong> = charges when you spend more money than you have in your account</div>
        <div class="vocab-item"><strong>mortgage</strong> = a loan to buy a house or property</div>
        <div class="vocab-item"><strong>established banks</strong> = traditional banks that have existed for a long time</div>
        <div class="vocab-item"><strong>regulation</strong> = official rules made by the government</div>
        <div class="vocab-item"><strong>rural areas</strong> = countryside locations away from cities</div>
      </div>
    `
  }
};

// QUESTIONS FOR EACH LEVEL
const QUESTIONS = {
  A1: [
    {
      q: "Where does Tom live?",
      options: ["Boston", "New York", "Los Angeles", "Chicago"],
      correct: 1
    },
    {
      q: "What time does Tom go to the bank?",
      options: ["9:00 a.m.", "10:00 a.m.", "11:00 a.m.", "2:00 p.m."],
      correct: 1
    },
    {
      q: "What is the name of the bank employee?",
      options: ["Laura", "Tom", "Angela", "Mary"],
      correct: 2
    },
    {
      q: "How much money does Tom deposit?",
      options: ["$50", "$100", "$200", "$1,450"],
      correct: 2
    },
    {
      q: "What is Tom's balance after he deposits money?",
      options: ["$1,200", "$1,400", "$1,450", "$1,500"],
      correct: 2
    },
    {
      q: "How much money does Tom withdraw?",
      options: ["$25", "$50", "$100", "$200"],
      correct: 1
    },
    {
      q: "What is Tom's final balance?",
      options: ["$1,200", "$1,350", "$1,400", "$1,450"],
      correct: 2
    },
    {
      q: "How does Tom feel at the end?",
      options: ["Angry", "Sad", "Happy", "Tired"],
      correct: 2
    },
    {
      q: "Angela gives Tom a receipt. What does the receipt show?",
      options: ["His name", "His address", "His new balance", "The time"],
      correct: 2
    },
    {
      q: "The bank visit was:",
      options: ["Long and difficult", "Easy and quick", "Expensive", "Boring"],
      correct: 1
    }
  ],
  A2B1: [
    {
      q: "Why did Laura want to open a savings account?",
      options: ["She needs money for rent", "She wants to buy a car next year", "Her boss told her to do it", "She wants to send money to her family"],
      correct: 1
    },
    {
      q: "How long has Laura been living in Chicago?",
      options: ["One month", "Two months", "Three months", "Six months"],
      correct: 2
    },
    {
      q: "What is Laura's profession?",
      options: ["Teacher", "Doctor", "Nurse", "Bank employee"],
      correct: 2
    },
    {
      q: "Why was Laura nervous about going to the bank?",
      options: ["She didn't have enough money", "She had never opened a savings account before and English is her second language", "She was late for the appointment", "She forgot her identification"],
      correct: 1
    },
    {
      q: "What are the two main differences between the savings account options?",
      options: ["Monthly fee and interest rate", "Debit card color and bank location", "Opening hours and closing hours", "Number of withdrawals and deposits"],
      correct: 0
    },
    {
      q: "Which savings account did Laura choose?",
      options: ["The one with no monthly fee", "The one with 0.5% interest", "The one with $500 minimum balance and 2% interest", "She didn't choose any account"],
      correct: 2
    },
    {
      q: "How much money did Laura deposit when she opened the account?",
      options: ["$200", "$500", "$800", "$1,000"],
      correct: 2
    },
    {
      q: "What did Laura set up to happen automatically each month?",
      options: ["Pay her rent", "Transfer $200 to her savings account", "Withdraw money", "Check her balance"],
      correct: 1
    },
    {
      q: "What forms of identification did Laura show?",
      options: ["Passport and work ID", "Driver's license and birth certificate", "Driver's license and passport", "Social security card and passport"],
      correct: 2
    },
    {
      q: "When will Laura receive her PIN?",
      options: ["Immediately", "The next day", "Within five business days", "Within two weeks"],
      correct: 2
    },
    {
      q: "How can Laura check her account balance?",
      options: ["Only by going to the bank", "Only by calling customer service", "Using the mobile app or online banking", "By mail only"],
      correct: 2
    },
    {
      q: "How did Laura feel at the end of the story?",
      options: ["Confused and worried", "Angry and frustrated", "Relieved and proud", "Tired and bored"],
      correct: 2
    }
  ],
  B2C1: [
    {
      q: "According to the Federal Reserve study, what percentage of Americans under 35 do all their banking through mobile apps?",
      options: ["25%", "Nearly 40%", "Over 50%", "60%"],
      correct: 1
    },
    {
      q: "Which advantage of digital banks is NOT mentioned in the article?",
      options: ["No minimum balance requirements", "Better interest rates on savings", "Free financial planning consultations", "No overdraft fees"],
      correct: 2
    },
    {
      q: "What does Marcus Rodriguez say is the main advantage of traditional banks?",
      options: ["They have lower fees", "They have more locations", "They offer trust, personal service, and expertise", "They have better mobile apps"],
      correct: 2
    },
    {
      q: "Which groups of people might have problems with the move to digital banking?",
      options: ["Young professionals and students", "People living in cities", "Older adults, people in rural areas, and those who prefer face-to-face service", "Tech company employees"],
      correct: 2
    },
    {
      q: "What is the main idea of this article?",
      options: ["Traditional banks are closing and will soon disappear", "Banking is changing as traditional and digital banks compete, which may affect different customers in different ways", "Digital banks are better than traditional banks", "The government should stop digital banks from operating"],
      correct: 1
    }
  ]
};

// GOOGLE FORM URL
const GOOGLE_FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSdAToQoJmHyWuL7ifDiwrdy0fs9-2ha68SI2Uo-1Jg9kFJRHg/formResponse";
// Field entry IDs
const FORM_FIELDS = {
  week: "entry.1442329542",
  name: "entry.683356736",
  level: "entry.171721789",
  score: "entry.413464778",
  total: "entry.971702683"
};
const CURRENT_WEEK = "Week 3";

let state = {
  screen: 'start',
  name: '',
  level: null,
  currentQuestion: 0,
  answers: [],
  submitted: false
};

function speak(text) {
  if ('speechSynthesis' in window) {
    window.speechSynthesis.cancel();
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.rate = 0.85;
    utterance.lang = 'en-US';
    window.speechSynthesis.speak(utterance);
  }
}

function speakReading() {
  const reading = READINGS[state.level];
  // Strip HTML tags for speech
  const text = reading.content.replace(/<[^>]*>/g, ' ').replace(/\s+/g, ' ').trim();
  speak(text);
}

function render() {
  const app = document.getElementById('app');
  
  if (state.screen === 'start') {
    app.innerHTML = renderStart();
  } else if (state.screen === 'reading') {
    app.innerHTML = renderReading();
  } else if (state.screen === 'questions') {
    app.innerHTML = renderQuestions();
  } else if (state.screen === 'results') {
    app.innerHTML = renderResults();
  }
}

function renderStart() {
  return `
    <div class="header">
      <span class="week-badge">WEEK 3</span>
      <h1>At the Bank</h1>
      <p class="subtitle">Banking & Money Management</p>
    </div>
    
    <div class="card">
      <div class="form-group">
        <label class="form-label">Your Full Name</label>
        <input type="text" class="form-input" id="nameInput" placeholder="Enter your full name" value="${state.name}">
      </div>
      
      <div class="form-group">
        <label class="form-label">Choose Your Level</label>
        <div class="level-grid">
          <button class="level-btn ${state.level === 'A1' ? 'selected' : ''}" onclick="selectLevel('A1')">
            <div class="level-name">A1 - Beginner</div>
            <div class="level-desc">Tom Goes to the Bank (10 questions)</div>
          </button>
          <button class="level-btn ${state.level === 'A2B1' ? 'selected' : ''}" onclick="selectLevel('A2B1')">
            <div class="level-name">A2/B1 - Intermediate</div>
            <div class="level-desc">Laura Opens a Savings Account (12 questions)</div>
          </button>
          <button class="level-btn ${state.level === 'B2C1' ? 'selected' : ''}" onclick="selectLevel('B2C1')">
            <div class="level-name">B2/C1 - Advanced</div>
            <div class="level-desc">Digital Banking Revolution (5 questions)</div>
          </button>
        </div>
      </div>
      
      <button class="btn btn-primary" onclick="startReading()" id="startBtn" disabled>
        Start Reading ‚Üí
      </button>
    </div>
    
    <p class="footer-note">SQA Education ‚Ä¢ Banking & Money Management Course</p>
  `;
}

function renderReading() {
  const reading = READINGS[state.level];
  const levelLabel = state.level === 'A1' ? 'A1' : state.level === 'A2B1' ? 'A2/B1' : 'B2/C1';
  const questionCount = QUESTIONS[state.level].length;
  
  return `
    <div class="header">
      <span class="week-badge">WEEK 3 ‚Ä¢ ${levelLabel}</span>
      <h1>Read the Story</h1>
      <p class="subtitle">Read carefully, then answer ${questionCount} questions</p>
    </div>
    
    <button class="audio-btn" onclick="speakReading()">
      üîä Listen to Story
    </button>
    
    <div class="reading-content">
      <div class="reading-title">üìñ ${reading.title}</div>
      ${reading.content}
    </div>
    
    <button class="btn btn-primary" onclick="startQuestions()">
      I'm Ready for Questions ‚Üí
    </button>
  `;
}

function renderQuestions() {
  const questions = QUESTIONS[state.level];
  const current = questions[state.currentQuestion];
  const progress = ((state.currentQuestion + 1) / questions.length) * 100;
  const levelLabel = state.level === 'A1' ? 'A1' : state.level === 'A2B1' ? 'A2/B1' : 'B2/C1';
  
  return `
    <div class="header" style="padding:20px 0">
      <span class="week-badge">WEEK 3 ‚Ä¢ ${levelLabel}</span>
    </div>
    
    <div class="progress-text">Question ${state.currentQuestion + 1} of ${questions.length}</div>
    <div class="progress-bar">
      <div class="progress-fill" style="width:${progress}%"></div>
    </div>
    
    <div class="question-card">
      <button class="audio-btn" onclick="speak('${current.q.replace(/'/g, "\\'")}')">
        üîä Listen
      </button>
      
      <div class="question-text">
        <span class="question-num">${state.currentQuestion + 1}</span>
        ${current.q}
      </div>
      
      <div class="options">
        ${current.options.map((opt, i) => `
          <div class="option ${state.answers[state.currentQuestion] === i ? 'selected' : ''}" onclick="selectAnswer(${i})">
            <span class="option-letter">${String.fromCharCode(65 + i)}</span>
            <span class="option-text">${opt}</span>
          </div>
        `).join('')}
      </div>
    </div>
    
    <div class="nav-row">
      ${state.currentQuestion > 0 ? `
        <button class="btn btn-secondary" onclick="prevQuestion()">‚Üê Back</button>
      ` : ''}
      <button class="btn btn-primary" onclick="nextQuestion()" ${state.answers[state.currentQuestion] === undefined ? 'disabled' : ''}>
        ${state.currentQuestion < questions.length - 1 ? 'Next ‚Üí' : 'See Results'}
      </button>
    </div>
  `;
}

function renderResults() {
  const questions = QUESTIONS[state.level];
  let correct = 0;
  
  questions.forEach((q, i) => {
    if (state.answers[i] === q.correct) correct++;
  });
  
  const percentage = Math.round((correct / questions.length) * 100);
  const passed = percentage >= 60;
  const levelLabel = state.level === 'A1' ? 'A1' : state.level === 'A2B1' ? 'A2/B1' : 'B2/C1';
  
  return `
    <div class="card">
      <div class="results-card">
        <div class="results-icon">${passed ? 'üéâ' : 'üìö'}</div>
        <div class="results-title">${passed ? 'Great Job!' : 'Keep Practicing!'}</div>
        <div class="results-score">${correct} / ${questions.length}</div>
        <div style="font-size:1.3rem;margin-bottom:10px;">${percentage}%</div>
        <div class="results-message">
          ${passed ? 'Excellent comprehension!' : 'Read the story again and try once more.'}
        </div>
        
        <div class="results-details">
          <div class="results-row">
            <span>Student Name:</span>
            <span>${state.name}</span>
          </div>
          <div class="results-row">
            <span>Level:</span>
            <span>${levelLabel}</span>
          </div>
          <div class="results-row">
            <span>Score:</span>
            <span>${correct}/${questions.length} (${percentage}%)</span>
          </div>
        </div>
        
        ${!state.submitted ? `
          <button class="btn btn-primary" onclick="submitResults()">
            ‚úì Submit My Results
          </button>
        ` : `
          <div class="submitted-msg">
            ‚úÖ Your results have been submitted!
          </div>
        `}
        
        <div class="nav-row">
          <button class="btn btn-secondary" onclick="reviewAnswers()">Review Answers</button>
          <button class="btn btn-secondary" onclick="startOver()">Try Again</button>
        </div>
      </div>
    </div>
  `;
}

function selectLevel(level) {
  state.level = level;
  render();
  checkStartBtn();
}

function checkStartBtn() {
  const nameInput = document.getElementById('nameInput');
  const startBtn = document.getElementById('startBtn');
  if (nameInput && startBtn) {
    state.name = nameInput.value.trim();
    startBtn.disabled = !(state.name && state.level);
  }
}

function startReading() {
  const nameInput = document.getElementById('nameInput');
  state.name = nameInput.value.trim();
  if (!state.name || !state.level) return;
  state.screen = 'reading';
  render();
}

function startQuestions() {
  state.screen = 'questions';
  state.currentQuestion = 0;
  state.answers = [];
  render();
}

function selectAnswer(index) {
  state.answers[state.currentQuestion] = index;
  render();
}

function prevQuestion() {
  if (state.currentQuestion > 0) {
    state.currentQuestion--;
    render();
  }
}

function nextQuestion() {
  const questions = QUESTIONS[state.level];
  if (state.currentQuestion < questions.length - 1) {
    state.currentQuestion++;
  } else {
    state.screen = 'results';
  }
  render();
}

function submitResults() {
  const questions = QUESTIONS[state.level];
  let correct = 0;
  questions.forEach((q, i) => {
    if (state.answers[i] === q.correct) correct++;
  });
  
  const levelLabel = state.level === 'A1' ? 'A1' : state.level === 'A2B1' ? 'A2/B1' : 'B2/C1';
  
  // Submit to Google Form
  const formData = new FormData();
  formData.append(FORM_FIELDS.week, CURRENT_WEEK);
  formData.append(FORM_FIELDS.name, state.name);
  formData.append(FORM_FIELDS.level, levelLabel);
  formData.append(FORM_FIELDS.score, correct);
  formData.append(FORM_FIELDS.total, questions.length);
  
  // Send to Google Form (no-cors mode for cross-origin)
  fetch(GOOGLE_FORM_URL, {
    method: 'POST',
    mode: 'no-cors',
    body: formData
  }).then(() => {
    state.submitted = true;
    render();
  }).catch(err => {
    console.error('Submit error:', err);
    state.submitted = true;
    render();
  });
}

function reviewAnswers() {
  alert('Review feature coming soon! For now, try the activity again to practice.');
}

function startOver() {
  state.screen = 'start';
  state.currentQuestion = 0;
  state.answers = [];
  state.submitted = false;
  render();
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  render();
  document.addEventListener('input', (e) => {
    if (e.target.id === 'nameInput') {
      checkStartBtn();
    }
  });
});

render();
</script>
</body>
</html>
