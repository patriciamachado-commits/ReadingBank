<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
<title>Week 1: Reading a Bank Statement</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;600;700&family=DM+Serif+Display&display=swap" rel="stylesheet">
<style>
:root{
  --primary:#0f766e;
  --primary-light:#14b8a6;
  --primary-dark:#134e4a;
  --accent:#f59e0b;
  --bg:#f0fdfa;
  --card:#ffffff;
  --text:#134e4a;
  --text-light:#5f9ea0;
  --success:#10b981;
  --error:#ef4444;
  --border:#99f6e4;
}
*{box-sizing:border-box;margin:0;padding:0}
body{
  font-family:'DM Sans',system-ui,sans-serif;
  background:var(--bg);
  min-height:100vh;
  color:var(--text);
  line-height:1.6;
}
.container{
  max-width:700px;
  margin:0 auto;
  padding:20px;
  min-height:100vh;
}
.header{
  text-align:center;
  padding:30px 0;
}
.week-badge{
  display:inline-block;
  background:var(--primary);
  color:#fff;
  font-size:0.8rem;
  font-weight:600;
  padding:6px 14px;
  border-radius:20px;
  margin-bottom:12px;
  letter-spacing:0.5px;
}
h1{
  font-family:'DM Serif Display',serif;
  font-size:2rem;
  color:var(--primary-dark);
  margin-bottom:8px;
}
.subtitle{
  font-size:1rem;
  color:var(--text-light);
}
.card{
  background:var(--card);
  border:2px solid var(--border);
  border-radius:16px;
  padding:24px;
  margin-bottom:20px;
  box-shadow:0 4px 20px rgba(15,118,110,0.08);
}
.form-group{
  margin-bottom:20px;
}
.form-label{
  display:block;
  font-weight:600;
  margin-bottom:8px;
  color:var(--primary-dark);
}
.form-input{
  width:100%;
  padding:14px 16px;
  border:2px solid var(--border);
  border-radius:10px;
  font-size:1rem;
  font-family:inherit;
  transition:all 0.2s;
}
.form-input:focus{
  outline:none;
  border-color:var(--primary);
  box-shadow:0 0 0 4px rgba(15,118,110,0.1);
}
.level-grid{
  display:grid;
  gap:12px;
}
.level-btn{
  background:linear-gradient(135deg,#f0fdfa,#ccfbf1);
  border:2px solid var(--border);
  border-radius:12px;
  padding:18px;
  cursor:pointer;
  text-align:left;
  transition:all 0.2s;
}
.level-btn:hover{
  border-color:var(--primary);
  transform:translateY(-2px);
  box-shadow:0 4px 15px rgba(15,118,110,0.15);
}
.level-btn.selected{
  border-color:var(--primary);
  background:linear-gradient(135deg,#ccfbf1,#99f6e4);
}
.level-name{
  font-weight:700;
  font-size:1.1rem;
  color:var(--primary-dark);
  margin-bottom:4px;
}
.level-desc{
  font-size:0.9rem;
  color:var(--text-light);
}
.btn{
  padding:14px 28px;
  border-radius:10px;
  border:none;
  font-size:1rem;
  font-weight:600;
  cursor:pointer;
  transition:all 0.2s;
  font-family:inherit;
}
.btn-primary{
  background:linear-gradient(135deg,var(--primary),var(--primary-dark));
  color:#fff;
  box-shadow:0 4px 15px rgba(15,118,110,0.3);
  width:100%;
}
.btn-primary:hover{
  transform:translateY(-2px);
  box-shadow:0 6px 20px rgba(15,118,110,0.4);
}
.btn-primary:disabled{
  opacity:0.5;
  cursor:not-allowed;
  transform:none;
}
.bank-statement{
  background:linear-gradient(135deg,#fefce8,#fef9c3);
  border:2px solid #fde047;
  border-radius:12px;
  padding:20px;
  margin:20px 0;
  font-family:'Courier New',monospace;
}
.bank-header{
  text-align:center;
  border-bottom:2px dashed #ca8a04;
  padding-bottom:15px;
  margin-bottom:15px;
}
.bank-name{
  font-weight:700;
  font-size:1.2rem;
  color:#854d0e;
}
.bank-info{
  font-size:0.85rem;
  color:#a16207;
  margin-top:5px;
}
.account-info{
  display:grid;
  grid-template-columns:1fr 1fr;
  gap:10px;
  margin-bottom:15px;
  font-size:0.9rem;
}
.account-info div{
  background:rgba(255,255,255,0.6);
  padding:8px 10px;
  border-radius:6px;
}
.account-label{
  font-size:0.75rem;
  color:#a16207;
  text-transform:uppercase;
}
.account-value{
  font-weight:600;
  color:#854d0e;
}
.transactions-title{
  font-weight:700;
  color:#854d0e;
  margin-bottom:10px;
  font-size:0.9rem;
  text-transform:uppercase;
}
.transaction{
  display:grid;
  grid-template-columns:90px 1fr auto;
  gap:10px;
  padding:10px;
  background:rgba(255,255,255,0.5);
  border-radius:6px;
  margin-bottom:8px;
  font-size:0.9rem;
}
.transaction.header{
  font-weight:700;
  background:rgba(202,138,4,0.2);
  font-size:0.8rem;
  text-transform:uppercase;
}
.t-date{color:#a16207}
.t-desc{color:#854d0e}
.t-amount{font-weight:600;text-align:right}
.t-amount.deposit{color:#059669}
.t-amount.withdrawal{color:#dc2626}
.balance-row{
  display:flex;
  justify-content:space-between;
  padding:12px;
  background:rgba(202,138,4,0.2);
  border-radius:6px;
  margin-top:15px;
  font-weight:700;
  color:#854d0e;
}
.question-card{
  background:#fff;
  border:2px solid var(--border);
  border-radius:12px;
  padding:20px;
  margin-bottom:15px;
}
.question-num{
  display:inline-block;
  background:var(--primary);
  color:#fff;
  width:28px;
  height:28px;
  border-radius:50%;
  text-align:center;
  line-height:28px;
  font-weight:600;
  font-size:0.9rem;
  margin-right:10px;
}
.question-text{
  font-weight:600;
  color:var(--primary-dark);
  margin-bottom:15px;
  font-size:1.05rem;
}
.options{
  display:grid;
  gap:10px;
}
.option{
  display:flex;
  align-items:center;
  gap:12px;
  padding:14px 16px;
  background:#f0fdfa;
  border:2px solid var(--border);
  border-radius:10px;
  cursor:pointer;
  transition:all 0.2s;
}
.option:hover{
  border-color:var(--primary-light);
  background:#ccfbf1;
}
.option.selected{
  border-color:var(--primary);
  background:#ccfbf1;
}
.option.correct{
  border-color:var(--success);
  background:#d1fae5;
}
.option.incorrect{
  border-color:var(--error);
  background:#fee2e2;
}
.option-letter{
  width:28px;
  height:28px;
  border-radius:50%;
  background:var(--border);
  display:flex;
  align-items:center;
  justify-content:center;
  font-weight:600;
  font-size:0.9rem;
  color:var(--primary-dark);
}
.option.selected .option-letter{
  background:var(--primary);
  color:#fff;
}
.option-text{
  flex:1;
  color:var(--text);
}
.progress-bar{
  background:var(--border);
  border-radius:10px;
  height:10px;
  margin-bottom:20px;
  overflow:hidden;
}
.progress-fill{
  background:linear-gradient(90deg,var(--primary-light),var(--primary));
  height:100%;
  transition:width 0.3s ease;
}
.progress-text{
  text-align:center;
  font-size:0.9rem;
  color:var(--text-light);
  margin-bottom:10px;
}
.results-card{
  text-align:center;
  padding:30px 20px;
}
.results-icon{
  font-size:4rem;
  margin-bottom:15px;
}
.results-title{
  font-family:'DM Serif Display',serif;
  font-size:1.8rem;
  color:var(--primary-dark);
  margin-bottom:10px;
}
.results-score{
  font-size:3rem;
  font-weight:700;
  color:var(--primary);
  margin:15px 0;
}
.results-message{
  font-size:1.1rem;
  color:var(--text-light);
  margin-bottom:25px;
}
.results-details{
  background:#f0fdfa;
  border-radius:10px;
  padding:15px;
  margin:20px 0;
  text-align:left;
}
.results-row{
  display:flex;
  justify-content:space-between;
  padding:8px 0;
  border-bottom:1px solid var(--border);
}
.results-row:last-child{
  border-bottom:none;
}
.nav-row{
  display:flex;
  gap:10px;
  margin-top:20px;
}
.nav-row .btn{
  flex:1;
}
.btn-secondary{
  background:#f0fdfa;
  color:var(--primary);
  border:2px solid var(--border);
}
.btn-secondary:hover{
  background:#ccfbf1;
  border-color:var(--primary);
}
.audio-btn{
  background:rgba(15,118,110,0.1);
  border:1px solid var(--border);
  color:var(--primary);
  padding:8px 14px;
  border-radius:8px;
  cursor:pointer;
  font-size:0.9rem;
  display:inline-flex;
  align-items:center;
  gap:6px;
  margin-bottom:15px;
  transition:all 0.2s;
}
.audio-btn:hover{
  background:rgba(15,118,110,0.2);
}
.footer-note{
  text-align:center;
  padding:20px;
  color:var(--text-light);
  font-size:0.85rem;
}
.submitted-msg{
  background:#d1fae5;
  border:2px solid #10b981;
  border-radius:10px;
  padding:15px;
  text-align:center;
  color:#065f46;
  margin-top:20px;
}
</style>
</head>
<body>
<div class="container" id="app"></div>

<script>
// BANK STATEMENTS FOR EACH LEVEL
const STATEMENTS = {
  A1: {
    bankName: "First City Bank",
    accountHolder: "Maria Garcia",
    accountNumber: "****1234",
    statementDate: "January 2025",
    startBalance: "$500.00",
    endBalance: "$425.00",
    transactions: [
      {date:"Jan 5", desc:"Paycheck - Work", amount:"+$800.00", type:"deposit"},
      {date:"Jan 8", desc:"Rent Payment", amount:"-$400.00", type:"withdrawal"},
      {date:"Jan 12", desc:"Grocery Store", amount:"-$75.00", type:"withdrawal"},
      {date:"Jan 15", desc:"Electric Bill", amount:"-$50.00", type:"withdrawal"},
      {date:"Jan 20", desc:"ATM Cash", amount:"-$100.00", type:"withdrawal"},
      {date:"Jan 25", desc:"Gas Station", amount:"-$40.00", type:"withdrawal"},
      {date:"Jan 28", desc:"Refund - Store", amount:"+$15.00", type:"deposit"},
      {date:"Jan 30", desc:"Phone Bill", amount:"-$25.00", type:"withdrawal"}
    ]
  },
  A2B1: {
    bankName: "National Trust Bank",
    accountHolder: "Carlos Rodriguez",
    accountNumber: "****5678",
    statementDate: "January 1-31, 2025",
    startBalance: "$1,250.00",
    endBalance: "$1,485.00",
    transactions: [
      {date:"Jan 2", desc:"Direct Deposit - ABC Company", amount:"+$1,500.00", type:"deposit"},
      {date:"Jan 3", desc:"Auto Insurance - Progressive", amount:"-$125.00", type:"withdrawal"},
      {date:"Jan 5", desc:"Transfer to Savings", amount:"-$200.00", type:"withdrawal"},
      {date:"Jan 8", desc:"Mortgage Payment", amount:"-$850.00", type:"withdrawal"},
      {date:"Jan 10", desc:"Walmart Supercenter", amount:"-$156.78", type:"withdrawal"},
      {date:"Jan 12", desc:"Netflix Subscription", amount:"-$15.99", type:"withdrawal"},
      {date:"Jan 15", desc:"Direct Deposit - ABC Company", amount:"+$1,500.00", type:"deposit"},
      {date:"Jan 18", desc:"Electric Company", amount:"-$89.45", type:"withdrawal"},
      {date:"Jan 20", desc:"Debit Card - Restaurant", amount:"-$45.50", type:"withdrawal"},
      {date:"Jan 22", desc:"ATM Withdrawal - Fee $3.00", amount:"-$203.00", type:"withdrawal"},
      {date:"Jan 25", desc:"Online Transfer from John D.", amount:"+$150.00", type:"deposit"},
      {date:"Jan 28", desc:"Credit Card Payment", amount:"-$350.00", type:"withdrawal"},
      {date:"Jan 30", desc:"Interest Earned", amount:"+$1.72", type:"deposit"}
    ]
  },
  B2C1: {
    bankName: "Metropolitan Financial Services",
    accountHolder: "Jennifer & Michael Thompson",
    accountNumber: "****9012",
    accountType: "Joint Checking Account",
    statementDate: "Statement Period: January 1-31, 2025",
    startBalance: "$4,892.33",
    endBalance: "$5,127.89",
    transactions: [
      {date:"Jan 2", desc:"ACH Direct Deposit - Thompson Consulting LLC", amount:"+$3,200.00", type:"deposit"},
      {date:"Jan 2", desc:"ACH Direct Deposit - City Hospital (M. Thompson)", amount:"+$2,450.00", type:"deposit"},
      {date:"Jan 3", desc:"Automatic Payment - Chase Mortgage #4521", amount:"-$1,875.00", type:"withdrawal"},
      {date:"Jan 3", desc:"Automatic Payment - Geico Auto Policy", amount:"-$189.50", type:"withdrawal"},
      {date:"Jan 5", desc:"Online Bill Pay - Verizon Wireless", amount:"-$156.99", type:"withdrawal"},
      {date:"Jan 7", desc:"Point of Sale - Whole Foods Market #1042", amount:"-$234.56", type:"withdrawal"},
      {date:"Jan 8", desc:"Recurring Transfer to Emergency Fund (Savings)", amount:"-$500.00", type:"withdrawal"},
      {date:"Jan 10", desc:"Zelle Payment to: David Chen (tutor)", amount:"-$150.00", type:"withdrawal"},
      {date:"Jan 12", desc:"Refund: Amazon.com Order #112-456", amount:"+$89.99", type:"deposit"},
      {date:"Jan 15", desc:"ACH Direct Deposit - Thompson Consulting LLC", amount:"+$3,200.00", type:"deposit"},
      {date:"Jan 15", desc:"Automatic Payment - 529 College Savings Plan", amount:"-$400.00", type:"withdrawal"},
      {date:"Jan 18", desc:"Wire Transfer Fee - International", amount:"-$35.00", type:"withdrawal"},
      {date:"Jan 18", desc:"Outgoing Wire - Maria Thompson (Spain)", amount:"-$500.00", type:"withdrawal"},
      {date:"Jan 20", desc:"POS Debit - Home Depot #3321", amount:"-$412.88", type:"withdrawal"},
      {date:"Jan 22", desc:"Overdraft Protection Transfer from Savings", amount:"+$0.00", type:"deposit"},
      {date:"Jan 25", desc:"Mobile Check Deposit - Birthday check", amount:"+$200.00", type:"deposit"},
      {date:"Jan 28", desc:"Automatic Payment - Term Life Insurance", amount:"-$125.00", type:"withdrawal"},
      {date:"Jan 30", desc:"Monthly Service Fee (waived - min balance met)", amount:"$0.00", type:"deposit"},
      {date:"Jan 31", desc:"Interest Earned (0.05% APY)", amount:"+$2.50", type:"deposit"}
    ]
  }
};

// QUESTIONS FOR EACH LEVEL
const QUESTIONS = {
  A1: [
    {
      q: "What is Maria's ending balance?",
      options: ["$500.00", "$425.00", "$800.00", "$400.00"],
      correct: 1
    },
    {
      q: "How much did Maria pay for rent?",
      options: ["$500.00", "$75.00", "$400.00", "$100.00"],
      correct: 2
    },
    {
      q: "What is a DEPOSIT?",
      options: ["Money you take out", "Money you put in", "A bill you pay", "A fee from the bank"],
      correct: 1
    },
    {
      q: "How much money did Maria get from her paycheck?",
      options: ["$400.00", "$500.00", "$800.00", "$425.00"],
      correct: 2
    },
    {
      q: "Where did Maria get a refund from?",
      options: ["The gas station", "The grocery store", "A store", "The bank"],
      correct: 2
    }
  ],
  A2B1: [
    {
      q: "How much money did Carlos receive from his employer in total this month?",
      options: ["$1,500.00", "$3,000.00", "$1,250.00", "$1,485.00"],
      correct: 1
    },
    {
      q: "What extra fee did Carlos pay when he used the ATM?",
      options: ["$0.00", "$3.00", "$15.99", "$200.00"],
      correct: 1
    },
    {
      q: "How much did Carlos transfer to his savings account?",
      options: ["$150.00", "$350.00", "$200.00", "$125.00"],
      correct: 2
    },
    {
      q: "Which payment happens automatically every month?",
      options: ["Walmart purchase", "ATM withdrawal", "Mortgage payment", "Restaurant payment"],
      correct: 2
    },
    {
      q: "What does 'Interest Earned' mean?",
      options: ["A fee you pay the bank", "Money the bank pays you for keeping money there", "A bill payment", "A transfer to another person"],
      correct: 1
    }
  ],
  B2C1: [
    {
      q: "What type of account do Jennifer and Michael have?",
      options: ["Individual savings account", "Business checking account", "Joint checking account", "Money market account"],
      correct: 2
    },
    {
      q: "What is the total amount deposited through direct deposits from both employers?",
      options: ["$5,650.00", "$8,850.00", "$3,200.00", "$11,050.00"],
      correct: 3
    },
    {
      q: "Why was the Monthly Service Fee $0.00?",
      options: ["The bank made an error", "They met the minimum balance requirement", "They have a premium account", "It was their first month"],
      correct: 1
    },
    {
      q: "What does 'ACH Direct Deposit' mean?",
      options: ["A cash deposit at a branch", "An electronic transfer directly into your account", "A wire transfer from overseas", "A mobile check deposit"],
      correct: 1
    },
    {
      q: "Based on this statement, which expense represents their largest monthly obligation?",
      options: ["Auto insurance", "Mortgage payment", "College savings contribution", "Groceries"],
      correct: 1
    }
  ]
};

// GOOGLE FORM URL
const GOOGLE_FORM_URL = "https://docs.google.com/forms/d/e/1FAIpQLSdAToQoJmHyWuL7ifDiwrdy0fs9-2ha68SI2Uo-1Jg9kFJRHg/formResponse";
// Field entry IDs
const FORM_FIELDS = {
  name: "entry.683356736",
  level: "entry.171721789",
  score: "entry.413464778",
  total: "entry.971702683"
};

let state = {
  screen: 'start',
  name: '',
  level: null,
  currentQuestion: 0,
  answers: [],
  submitted: false
};

function speak(text) {
  if ('speechSynthesis' in window) {
    window.speechSynthesis.cancel();
    const utterance = new SpeechSynthesisUtterance(text);
    utterance.rate = 0.85;
    utterance.lang = 'en-US';
    window.speechSynthesis.speak(utterance);
  }
}

function render() {
  const app = document.getElementById('app');
  
  if (state.screen === 'start') {
    app.innerHTML = renderStart();
  } else if (state.screen === 'reading') {
    app.innerHTML = renderReading();
  } else if (state.screen === 'questions') {
    app.innerHTML = renderQuestions();
  } else if (state.screen === 'results') {
    app.innerHTML = renderResults();
  }
}

function renderStart() {
  return `
    <div class="header">
      <span class="week-badge">WEEK 1</span>
      <h1>Reading a Bank Statement</h1>
      <p class="subtitle">Banking & Money Management</p>
    </div>
    
    <div class="card">
      <div class="form-group">
        <label class="form-label">Your Full Name</label>
        <input type="text" class="form-input" id="nameInput" placeholder="Enter your full name" value="${state.name}">
      </div>
      
      <div class="form-group">
        <label class="form-label">Choose Your Level</label>
        <div class="level-grid">
          <button class="level-btn ${state.level === 'A1' ? 'selected' : ''}" onclick="selectLevel('A1')">
            <div class="level-name">A1 - Beginner</div>
            <div class="level-desc">Simple words and short sentences</div>
          </button>
          <button class="level-btn ${state.level === 'A2B1' ? 'selected' : ''}" onclick="selectLevel('A2B1')">
            <div class="level-name">A2/B1 - Intermediate</div>
            <div class="level-desc">More details and vocabulary</div>
          </button>
          <button class="level-btn ${state.level === 'B2C1' ? 'selected' : ''}" onclick="selectLevel('B2C1')">
            <div class="level-name">B2/C1 - Advanced</div>
            <div class="level-desc">Complex banking terms and analysis</div>
          </button>
        </div>
      </div>
      
      <button class="btn btn-primary" onclick="startReading()" id="startBtn" disabled>
        Start Reading ‚Üí
      </button>
    </div>
    
    <p class="footer-note">SQA Education ‚Ä¢ Banking & Money Management Course</p>
  `;
}

function renderReading() {
  const stmt = STATEMENTS[state.level];
  const levelLabel = state.level === 'A1' ? 'A1' : state.level === 'A2B1' ? 'A2/B1' : 'B2/C1';
  
  return `
    <div class="header">
      <span class="week-badge">WEEK 1 ‚Ä¢ ${levelLabel}</span>
      <h1>Read the Bank Statement</h1>
      <p class="subtitle">Read carefully, then answer 5 questions</p>
    </div>
    
    <button class="audio-btn" onclick="readStatement()">
      üîä Listen to Statement
    </button>
    
    <div class="bank-statement">
      <div class="bank-header">
        <div class="bank-name">üè¶ ${stmt.bankName}</div>
        <div class="bank-info">${stmt.statementDate}</div>
      </div>
      
      <div class="account-info">
        <div>
          <div class="account-label">Account Holder</div>
          <div class="account-value">${stmt.accountHolder}</div>
        </div>
        <div>
          <div class="account-label">Account Number</div>
          <div class="account-value">${stmt.accountNumber}</div>
        </div>
        <div>
          <div class="account-label">Starting Balance</div>
          <div class="account-value">${stmt.startBalance}</div>
        </div>
        <div>
          <div class="account-label">Ending Balance</div>
          <div class="account-value">${stmt.endBalance}</div>
        </div>
      </div>
      
      <div class="transactions-title">Transactions</div>
      
      <div class="transaction header">
        <div>Date</div>
        <div>Description</div>
        <div>Amount</div>
      </div>
      
      ${stmt.transactions.map(t => `
        <div class="transaction">
          <div class="t-date">${t.date}</div>
          <div class="t-desc">${t.desc}</div>
          <div class="t-amount ${t.type}">${t.amount}</div>
        </div>
      `).join('')}
      
      <div class="balance-row">
        <span>Ending Balance:</span>
        <span>${stmt.endBalance}</span>
      </div>
    </div>
    
    <button class="btn btn-primary" onclick="startQuestions()">
      I'm Ready for Questions ‚Üí
    </button>
  `;
}

function renderQuestions() {
  const questions = QUESTIONS[state.level];
  const current = questions[state.currentQuestion];
  const progress = ((state.currentQuestion + 1) / questions.length) * 100;
  const levelLabel = state.level === 'A1' ? 'A1' : state.level === 'A2B1' ? 'A2/B1' : 'B2/C1';
  
  return `
    <div class="header" style="padding:20px 0">
      <span class="week-badge">WEEK 1 ‚Ä¢ ${levelLabel}</span>
    </div>
    
    <div class="progress-text">Question ${state.currentQuestion + 1} of ${questions.length}</div>
    <div class="progress-bar">
      <div class="progress-fill" style="width:${progress}%"></div>
    </div>
    
    <div class="question-card">
      <button class="audio-btn" onclick="speak('${current.q.replace(/'/g, "\\'")}')">
        üîä Listen
      </button>
      
      <div class="question-text">
        <span class="question-num">${state.currentQuestion + 1}</span>
        ${current.q}
      </div>
      
      <div class="options">
        ${current.options.map((opt, i) => `
          <div class="option ${state.answers[state.currentQuestion] === i ? 'selected' : ''}" onclick="selectAnswer(${i})">
            <span class="option-letter">${String.fromCharCode(65 + i)}</span>
            <span class="option-text">${opt}</span>
          </div>
        `).join('')}
      </div>
    </div>
    
    <div class="nav-row">
      ${state.currentQuestion > 0 ? `
        <button class="btn btn-secondary" onclick="prevQuestion()">‚Üê Back</button>
      ` : ''}
      <button class="btn btn-primary" onclick="nextQuestion()" ${state.answers[state.currentQuestion] === undefined ? 'disabled' : ''}>
        ${state.currentQuestion < questions.length - 1 ? 'Next ‚Üí' : 'See Results'}
      </button>
    </div>
  `;
}

function renderResults() {
  const questions = QUESTIONS[state.level];
  let correct = 0;
  
  questions.forEach((q, i) => {
    if (state.answers[i] === q.correct) correct++;
  });
  
  const percentage = Math.round((correct / questions.length) * 100);
  const passed = percentage >= 60;
  const levelLabel = state.level === 'A1' ? 'A1' : state.level === 'A2B1' ? 'A2/B1' : 'B2/C1';
  
  return `
    <div class="card">
      <div class="results-card">
        <div class="results-icon">${passed ? 'üéâ' : 'üìö'}</div>
        <div class="results-title">${passed ? 'Great Job!' : 'Keep Practicing!'}</div>
        <div class="results-score">${correct} / ${questions.length}</div>
        <div style="font-size:1.3rem;margin-bottom:10px;">${percentage}%</div>
        <div class="results-message">
          ${passed ? 'You understand bank statements well!' : 'Review the bank statement and try again.'}
        </div>
        
        <div class="results-details">
          <div class="results-row">
            <span>Student Name:</span>
            <span>${state.name}</span>
          </div>
          <div class="results-row">
            <span>Level:</span>
            <span>${levelLabel}</span>
          </div>
          <div class="results-row">
            <span>Score:</span>
            <span>${correct}/${questions.length} (${percentage}%)</span>
          </div>
        </div>
        
        ${!state.submitted ? `
          <button class="btn btn-primary" onclick="submitResults()">
            ‚úì Submit My Results
          </button>
        ` : `
          <div class="submitted-msg">
            ‚úÖ Your results have been submitted!
          </div>
        `}
        
        <div class="nav-row">
          <button class="btn btn-secondary" onclick="reviewAnswers()">Review Answers</button>
          <button class="btn btn-secondary" onclick="startOver()">Try Again</button>
        </div>
      </div>
    </div>
  `;
}

function selectLevel(level) {
  state.level = level;
  render();
  checkStartBtn();
}

function checkStartBtn() {
  const nameInput = document.getElementById('nameInput');
  const startBtn = document.getElementById('startBtn');
  if (nameInput && startBtn) {
    state.name = nameInput.value.trim();
    startBtn.disabled = !(state.name && state.level);
  }
}

function startReading() {
  const nameInput = document.getElementById('nameInput');
  state.name = nameInput.value.trim();
  if (!state.name || !state.level) return;
  state.screen = 'reading';
  render();
}

function readStatement() {
  const stmt = STATEMENTS[state.level];
  let text = `Bank Statement from ${stmt.bankName}. Account holder: ${stmt.accountHolder}. `;
  text += `Starting balance: ${stmt.startBalance}. `;
  text += `Here are the transactions: `;
  stmt.transactions.forEach(t => {
    text += `${t.date}, ${t.desc}, ${t.amount}. `;
  });
  text += `Ending balance: ${stmt.endBalance}.`;
  speak(text);
}

function startQuestions() {
  state.screen = 'questions';
  state.currentQuestion = 0;
  state.answers = [];
  render();
}

function selectAnswer(index) {
  state.answers[state.currentQuestion] = index;
  render();
}

function prevQuestion() {
  if (state.currentQuestion > 0) {
    state.currentQuestion--;
    render();
  }
}

function nextQuestion() {
  const questions = QUESTIONS[state.level];
  if (state.currentQuestion < questions.length - 1) {
    state.currentQuestion++;
  } else {
    state.screen = 'results';
  }
  render();
}

function submitResults() {
  const questions = QUESTIONS[state.level];
  let correct = 0;
  questions.forEach((q, i) => {
    if (state.answers[i] === q.correct) correct++;
  });
  
  const levelLabel = state.level === 'A1' ? 'A1' : state.level === 'A2B1' ? 'A2/B1' : 'B2/C1';
  
  // Submit to Google Form
  const formData = new FormData();
  formData.append(FORM_FIELDS.name, state.name);
  formData.append(FORM_FIELDS.score, correct);
  formData.append(FORM_FIELDS.level, levelLabel);
  formData.append(FORM_FIELDS.total, questions.length);
  
  // Send to Google Form (no-cors mode for cross-origin)
  fetch(GOOGLE_FORM_URL, {
    method: 'POST',
    mode: 'no-cors',
    body: formData
  }).then(() => {
    state.submitted = true;
    render();
  }).catch(err => {
    console.error('Submit error:', err);
    state.submitted = true;
    render();
  });
}

function reviewAnswers() {
  alert('Review feature coming soon! For now, try the activity again to practice.');
}

function startOver() {
  state.screen = 'start';
  state.currentQuestion = 0;
  state.answers = [];
  state.submitted = false;
  render();
}

// Initialize
document.addEventListener('DOMContentLoaded', () => {
  render();
  document.addEventListener('input', (e) => {
    if (e.target.id === 'nameInput') {
      checkStartBtn();
    }
  });
});

render();
</script>
</body>
</html>
